{% extends "theme_base.html" %}

{% load staticfiles %}

{% block search_bar %}{% endblock %}

{% block content %}
  <div id="search-options">
    <h2>Search</h2>

    <form method="get" action=".">
      <table>
        {{ form.as_table }}
        <tr>
          <td>&nbsp;</td>
          <td>
            <input type="submit" value="Search">
          </td>
        </tr>
        </table>
    </form>
  </div>

  <div id="search-content">
    {% if tags %}
    <div class="tags">
      <h3>Tags</h3>
    </div>
    {% endif %}

    {% if query %}
      <div class="results{% if not tags %}-fullwidth{% endif %}">
        <h3>Results</h3>

        {% for result in page.object_list %}
          {% with result.object as recipe %}
          <div class="recipe-summary">
            {% with recipe.get_image_url as image_url %}
            <div class="recipe-{% if image_url %}image{% else %}holder{% endif %}">
              <img src="{% if image_url %}{{ image_url }}{% else %}{% static "img/large-bowl.png" %}{% endif %}" />
            </div>
            {% endwith %}
          </div>

          <div class="recipe-text">
            <h2><a href="">{{ recipe.title }}</a></h2>
            {% with recipe.likes as likes %}
            {% with recipe.dislikes as dislikes %}
              <p>
              {% if likes or dislikes %}
              <img src="{% static "img/thumbs-up.png" %}" /> {{ likes }} Like{{ likes|pluralize }}
              <img src="{% static "img/thumbs-down.png" %}" /> {{ dislikes }} Dislike{{ dislikes|pluralize }}
              {% endif %}
              </p>
            {% endwith %}
            {% endwith %}
            <p>{{ recipe.description }}  <a href="">More</a></p>
            <p>{% for tag in recipe.tags.all %}<span class="tag">{{ tag }}</span>{% endfor %}</p>
          </div>
          {% endwith %}
        </div>
        {% empty %}
          <p>No results found.</p>
        {% endfor %}

            {% if page.has_previous or page.has_next %}
                <div>
                    {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
                    |
                    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
                </div>
            {% endif %}
        {% else %}
            <p>Enter a search term in the form above to start searching.</p>
        {% endif %}
    </div>
  </div>
{% endblock %}